---
title: 如何升級 Application Virtualization Client
description: 如何升級 Application Virtualization Client
author: dansimp
ms.assetid: 2a75d8b5-da88-456c-85bb-f5bd3d470f7f
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop, appcompat, virtualization
ms.mktglfcycl: deploy
ms.sitesec: library
ms.prod: w10
ms.date: 06/16/2016
ms.openlocfilehash: b9748fbdba7c8d2777a06c93295e4582be784dd1
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/26/2020
ms.locfileid: "10801022"
---
# 如何升級 Application Virtualization Client


您可以使用下列程式來升級應用程式虛擬化（app-v）桌面用戶端或適用于遠端桌面服務的 App-v 用戶端（以前稱為 [終端服務]）。 您可以透過在先前安裝較舊版本的新版本來升級用戶端。 當您升級用戶端時，安裝程式軟體會自動保留及遷移使用者的虛擬應用程式設定。 需要系統管理許可權才能執行安裝程式。

**記事** 在升級到應用程式虛擬化（App-v）4.5 或更新版本期間，會變更 HKCU 登錄機碼的許可權。 如此一來，使用者就會遺失先前設定的使用者設定，例如使用者設定的中斷式模式設定。 如果使用者未受到限制許可權鎖定的用戶端使用者介面行為，使用者就可以在發佈重新整理後重設這些喜好設定。

 

**重要** 當您升級至4.6 或更新版本的 App-V 用戶端時，您必須針對電腦的作業系統、32位或64位使用正確的安裝程式。 如果您使用的是錯誤的安裝程式，安裝將會失敗，並會顯示錯誤訊息。

 

**升級應用程式虛擬化桌面用戶端**

1.  關閉所有虛擬應用程式，以滑鼠右鍵按一下顯示在 Windows 桌面通知區域中的 app-v 桌面用戶端圖示，**然後選取 [** 結束] 以關閉現有的用戶端。

2.  在取得正確的安裝程式封存檔案並將它儲存到您的電腦之後，請按兩下它以展開封存。

3.  流覽以尋找 setup.exe 檔案，然後按兩下 setup.exe 以開始安裝。

4.  此嚮導會檢查系統，以確保已安裝所有必備軟體，並會提示您安裝下列任何一項（如果遺失的話）：

    -   Microsoft VisualC + + 2005SP1 可再發行套件（x86）

    -   Microsoft Core XML Services （MSXML） 6.0 SP1 （x86）

    -   Microsoft 應用程式錯誤報表

    **記事** 針對版本4.6 及更高版本，此嚮導也會安裝下列軟體必備元件：

    -   Microsoft VisualC + + 2008SP1 可再發行套件（x86）

     

5.  按一下 **\[安裝\]**。 隨即會顯示安裝進度，且狀態會從 [**擱置**] 變更為 [**安裝**]。 成功完成每個步驟時，安裝狀態會變更為 [**成功**]。

6.  當**應用程式虛擬化桌面用戶端**對話方塊出現並顯示一則訊息，指出電腦上已找到較舊版本的用戶端時，請按一下 **[下一步]** 以升級至新版本。

7.  在顯示 [**授權協定**] 畫面時，請閱讀授權協定，如果您同意，請按一下 [**我接受授權合約中的條款**]，然後按 **[下一步]**。

8.  當 [InstallShield] 嚮導顯示 [**準備好升級程式**] 對話方塊畫面時，請按一下 [**升級**] 開始升級。 下一個畫面會顯示用戶端已安裝。

    **警告** 如果您沒有在步驟1中關閉用戶端程式，您可能會在 [**使用中**的警告] 畫面上看到一個檔案。 如果發生這種情況，請以滑鼠右鍵按一下顯示在桌面通知區域中的 app-v 用戶端圖示，**然後選取 [** 結束] 以關閉現有的用戶端。 然後按一下 [**重試**] 繼續。

     

9.  當安裝順利完成時，系統會提示您重新開機電腦。 您必須重新開機電腦才能完成安裝。

    **小心** 如果升級由於任何原因而失敗，您必須重新開機電腦，才能再次嘗試升級。

     

**使用命令列升級應用程式虛擬化用戶端**

1.  如果您使用 setup.msi 程式升級 App-v 用戶端，請確定已安裝任何必要的必備軟體。

    **重要**  
    -   針對應用程式-V 用戶端的4.6 及更新版本，setup.msi 程式會檢查系統並失敗，並顯示錯誤訊息，指出安裝程式無法在未安裝必備軟體時繼續執行。

    -   在應用程式-V 版本4.6 中，在升級期間無法使用命令列參數，將會被忽略。

     

2.  下列命令列範例使用 setup.msi 檔案來升級 App-v 用戶端。 您必須使用正確的用戶端安裝程式，視您是要升級 App-v Desktop 用戶端或適用于遠端桌面服務的 App-v 用戶端（以前稱為 [終端服務]）。

    **msiexec.exe/i "setup.msi"**

    **重要** 只有在值包含空格時，才需要使用引號。 為了保持一致性，前一個範例中的所有實例都會顯示為引號。

     

**若要為遠端桌面服務升級應用程式虛擬化用戶端**

1.  遵循貴組織的標準原則，在遠端桌面工作階段主機（RDSession 主機）伺服器上安裝或升級應用程式。 如果系統是伺服器陣列的一部分，請從伺服器伺服器陣列中移除 RDSession 主機。

2.  若要升級遠端桌面服務（舊稱終端服務）的 app-v 用戶端，您必須使用命令列，因為您無法在 RDSession 主機上手動升級用戶端。

    **記事** 在 App-v 版本4.6 及更新版本中，除了使用命令列升級用戶端之外，您還可以使用遠端桌面會話。 啟動遠端桌面會話時，不需要特殊的參數。

     

3.  在遠端桌面服務升級的用戶端完成後，請重新開機並登入 RDSession 主機。

4.  重新開機系統之後，請將伺服器新增到伺服器伺服器陣列中。

    **小心** 如果升級由於任何原因而失敗，您必須重新開機電腦，才能再次嘗試升級。

     

## 相關主題


[Application Virtualization 部署與升級考量](application-virtualization-deployment-and-upgrade-considerations.md)

 

 





